<html lang="en" xmlns:th="http://www.thymeleaf.org">

<section class="py-5" th:fragment="product">
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-12">
				<div class="bootstrap-tabs product-tabs">
					<div class="tabs-header d-flex justify-content-between border-bottom my-5">
						<h3 style="color: #007bff; text-align: center; width: 100%;">üïì S·∫£n ph·∫©m s·∫Øp khuy·∫øn m√£i</h3>
					</div>

					<div class="mb-5" style="padding:0px 80px;">
						<div class="product-grid"
							style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: flex-start;">
							<!-- L·∫∑p qua s·∫£n ph·∫©m s·∫Øp khuy·∫øn m√£i -->
							<div class="product-item" th:each="sp : ${sanPhamsSapKhuyenMai}" style="
				width: calc(20% - 15px); 
				min-height: 350px; 
				padding: 0px; 
				display: flex; 
				flex-direction: column; 
				justify-content: space-between; 
				transition: transform 0.2s ease, box-shadow 0.3s ease; 
				border-radius: 10px; 
				background-color: #fff;" onmouseover="this.style.borderColor='#ffc107';"
								onmouseout="this.style.borderColor='#ddd';">

								<div>
									<!-- Container s·∫£n ph·∫©m -->
									<div class="product-item"
										style="position: relative; margin:0px; padding-bottom: 0px;">
										<!-- H√¨nh ·∫£nh s·∫£n ph·∫©m -->
										<figure th:if="${sp != null}">
											<a th:href="@{'/product/' + ${sp.maSanPham}}" th:title="${sp.tenSanPham}">
												<img th:src="@{'/upload/' + ${sp.hinhAnh}}" class="tab-image"
													style="width: 100%; height: 200px; object-fit: cover; border-radius: 5px; display: block;"
													alt="S·∫£n ph·∫©m">
											</a>
										</figure>

										<div class="product-pricing"
											style="display: flex; justify-content: space-between; align-items: flex-start;">

											<!-- B√äN TR√ÅI: Gi√° g·ªëc + Gi√° sau gi·∫£m -->
											<div
												style="display: flex; flex-direction: column; align-items: flex-start;">

												<!-- Gi√° g·ªëc (g·∫°ch ngang, nh·ªè h∆°n) -->
												<div style="font-size: 12px; color: #999; text-decoration: line-through;"
													th:if="${sanPhamSapKhuyenMaiMap[sp.maSanPham] != null}">
													<span
														th:text="${#numbers.formatDecimal(sp.donGiaBan, 0, 'COMMA', 0, 'POINT')} + ' ƒë'"></span>
												</div>

												<!-- Gi√° sau gi·∫£m (to, ƒë·ªè) -->
												<div style="font-size: 14px; font-weight: bold; color: #e74c3c;"
													th:if="${sanPhamSapKhuyenMaiMap[sp.maSanPham] != null}">
													<span
														th:text="${#numbers.formatDecimal(sp.donGiaBan.subtract(sp.donGiaBan.multiply(sanPhamSapKhuyenMaiMap[sp.maSanPham].phanTramGiamGia).divide(100)), 0, 'COMMA', 0, 'POINT')} + ' ƒë'"></span>
												</div>
											</div>

											<!-- B√äN PH·∫¢I: Gi·∫£m %, T·ª´ ng√†y -->
											<div th:if="${sanPhamSapKhuyenMaiMap[sp.maSanPham] != null}"
												style="display: flex; flex-direction: column; align-items: flex-end; font-size: 11px;">
												<span style="color: #ff5722; font-weight: bold;"
													th:text="'Gi·∫£m ' + ${sanPhamSapKhuyenMaiMap[sp.maSanPham].phanTramGiamGia} + '%'"></span>
												<span style="color: #007bff; font-weight: bold;"
													th:text="'T·ª´: ' + ${#dates.format(sanPhamSapKhuyenMaiMap[sp.maSanPham].ngayBatDau, 'dd/MM/yyyy')}"></span>
											</div>
										</div>



										<!-- Th∆∞∆°ng hi·ªáu -->
										<p class="product-brand" th:text="${sanPhamThuongHieuMap[sp.maSanPham]}"
											style="font-size: 12px; color: green; font-weight: bold; margin-bottom: 0px;">
										</p>

										<!-- T√™n s·∫£n ph·∫©m -->
										<p class="product-title" th:text="${sp.tenSanPham}"
											style="font-size: 16px; font-weight: bold; color: #333; margin-bottom: 1px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
										</p>

										<!-- ƒê√°nh gi√° -->
										<div class="product-rating"
											style="color: #f1c40f; font-size: 14px; margin-top: 2px;">
											<span
												th:text="${sanPhamAverageRatingMap[sp.maSanPham] != null ? sanPhamAverageRatingMap[sp.maSanPham] + ' ‚òÖ' : 'Ch∆∞a c√≥ ƒë√°nh gi√°'}"></span>
										</div>

										<!-- S·ªë l∆∞·ª£ng t·ªìn -->
										<span class="remaining-quantity"
											style="font-size: 12px; color: #555; display: block; margin-top: 5px;">
											S·ªë l∆∞·ª£ng: <span th:text="${sanPhamSoLuongTonKhoMap[sp.maSanPham]}"
												style="font-size: 12px;">0</span>
											<span class="qty" th:text="${sp.donViTinh.tenDonVi}"
												style="font-size: 11px;">ƒê∆°n v·ªã</span>
										</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>


				<div class="bootstrap-tabs product-tabs">
					<div class="tabs-header d-flex justify-content-between border-bottom my-5">
						<h3 style="color: #dc3545; text-align: center; width: 100%;">üî• S·∫£n ph·∫©m ƒëang khuy·∫øn m√£i</h3>
					</div>

					<div class="mb-5" style="padding:0px 80px;">
						<div class="product-grid"
							style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: flex-start;">
							<!-- L·∫∑p qua s·∫£n ph·∫©m khuy·∫øn m√£i -->
							<div class="product-item" th:each="sp : ${sanPhamsKhuyenMai}" style="
			width: calc(20% - 15px); 
			min-height: 350px; 
			padding: 0px; 
			display: flex; 
			flex-direction: column; 
			justify-content: space-between; 
			transition: transform 0.2s ease, box-shadow 0.3s ease; 
			border-radius: 10px; 
			background-color: #fff; 
			" onmouseover="this.style.borderColor='#ffc107';" onmouseout="this.style.borderColor='#ddd';">
								<div>
									<!-- Container s·∫£n ph·∫©m -->
									<div class="product-item"
										style="position: relative; margin:0px; padding-bottom: 0px;">

										<!-- H√¨nh ·∫£nh s·∫£n ph·∫©m -->
										<figure th:if="${sp != null}">
											<a th:href="@{'/product/' + ${sp.maSanPham}}" th:title="${sp.tenSanPham}">
												<img th:src="@{'/upload/' + ${sp.hinhAnh}}" class="tab-image"
													style="width: 100%; height: 200px; object-fit: cover; border-radius: 5px; display: block;"
													alt="S·∫£n ph·∫©m">
											</a>
										</figure>

										<!-- Gi√° v√† gi·∫£m gi√° -->
										<div class="product-pricing"
											style="display: flex; align-items: center; gap: 13px; justify-content: space-between;">
											<div class="product-price"
												style="font-size: 14px; font-weight: bold; color: #e74c3c;">
												<span
													th:text="${sanPhamGiaSauGiamMap[sp.maSanPham] != null ? #numbers.formatDecimal(sanPhamGiaSauGiamMap[sp.maSanPham], 0, 'COMMA', 0, 'POINT') + ' ƒë' : 'ƒêang c·∫≠p nh·∫≠t'}"></span>
											</div>

											<div style="display: flex; align-items: center; gap: 5px;">
												<div th:if="${sanPhamKhuyenMaiMap[sp.maSanPham] != null}"
													style="font-size: 10px; color: #999; text-decoration: line-through; text-align: right;">
													<span
														th:text="${#numbers.formatDecimal(sp.donGiaBan, 0, 'COMMA', 0, 'POINT')} + ' ƒë'"></span>
												</div>

												<!-- Ph·∫ßn trƒÉm gi·∫£m gi√° -->
												<span th:if="${sanPhamKhuyenMaiMap[sp.maSanPham] != null}"
													th:text="'-' + ${sanPhamKhuyenMaiMap[sp.maSanPham].phanTramGiamGia} + '%'"
													style="background: #ff4d4f; color: white; padding: 2px 6px; font-size: 10px; border-radius: 3px; font-weight: bold;">
												</span>
											</div>
										</div>

										<!-- Th∆∞∆°ng hi·ªáu -->
										<p class="product-brand" th:text="${sanPhamThuongHieuMap[sp.maSanPham]}"
											style="font-size: 12px; color: green; font-weight: bold; margin-bottom: 0px;">
										</p>

										<!-- T√™n s·∫£n ph·∫©m -->
										<p class="product-title" th:text="${sp.tenSanPham}"
											style="font-size: 16px; font-weight: bold; color: #333; margin-bottom: 1px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
										</p>

										<!-- ƒê√°nh gi√° -->
										<div class="product-rating"
											style="color: #f1c40f; font-size: 14px; margin-top: 2px;">
											<span
												th:text="${sanPhamAverageRatingMap[sp.maSanPham] != null ? sanPhamAverageRatingMap[sp.maSanPham] + ' ‚òÖ' : 'Ch∆∞a c√≥ ƒë√°nh gi√°'}"></span>
										</div>

										<!-- S·ªë l∆∞·ª£ng t·ªìn -->
										<span class="remaining-quantity"
											style="font-size: 12px; color: #555; display: block; margin-top: 5px;">
											S·ªë l∆∞·ª£ng: <span th:text="${sanPhamSoLuongTonKhoMap[sp.maSanPham]}"
												style="font-size: 12px;">0</span>
											<span class="qty" th:text="${sp.donViTinh.tenDonVi}"
												style="font-size: 11px;">ƒê∆°n v·ªã</span>
										</span>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="tabs-header d-flex justify-content-between border-bottom my-5">
						<h3 style=" text-align: center; width: 100%;"> T·∫•t C·∫£ S·∫£n ph·∫©m</h3>
					</div>

					<div class="" id="" style="padding:0px 80px;">
						<!-- Hi·ªÉn th·ªã t·∫•t c·∫£ s·∫£n ph·∫©m -->
						<div class="tab-pane fade show active" id="nav-all" role="tabpanel"
							aria-labelledby="nav-all-tab">
							<div class="product-grid"
								style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: flex-start;">
								<!-- L·∫∑p qua t·∫•t c·∫£ c√°c s·∫£n ph·∫©m v√† hi·ªÉn th·ªã -->
								<div class="product-item" th:each="sanPham : ${sanPhams}" style="
								
									width: calc(20% - 15px); 
						            min-height: 350px; 
						            padding: 0px; 
						            display: flex; 
						            flex-direction: column; 
						            justify-content: space-between; 
						            transition: transform 0.2s ease, box-shadow 0.3s ease; 
						            border-radius: 10px; 
						            background-color: #fff; 
						            " onmouseover="this.style.borderColor='#ffc107';" onmouseout="this.style.borderColor='#ddd';">
									<div>
										<!-- Container s·∫£n ph·∫©m -->
										<div class="product-item"
											style="position: relative; margin:0px; padding-bottom: 0px;">


											<!-- N√∫t y√™u th√≠ch d√†nh cho ng∆∞·ªùi ch∆∞a ƒëƒÉng nh·∫≠p 
											<a href="javascript:void(0);" class="btn-wishlist"
												th:if="${#authentication.name == 'anonymousUser'}"
												data-bs-toggle="offcanvas" data-bs-target="#offcanvasLoginAlert">
												<svg width="24" height="24">
													<use xlink:href="#heart"></use>
												</svg>
											</a>-->
											<!-- N√∫t y√™u th√≠ch d√†nh cho ng∆∞·ªùi ƒë√£ ƒëƒÉng nh·∫≠p 
											<a href="javascript:void(0);"
												th:onclick="'toggleFavorite(' + ${sanPham.maSanPham} + ')'"
												th:if="${#authentication.name != 'anonymousUser'}"
												th:classappend="${favoriteProductIds.contains(sanPham.maSanPham) ? ' btn-wishlist-liked' : ' btn-wishlist'}"
												th:id="'favorite-' + ${sanPham.maSanPham}"
												th:data-liked="${favoriteProductIds.contains(sanPham.maSanPham)}"
												class="btn-wishlist">
												<svg class="heart-icon" width="24" height="24">
													<use xlink:href="#heart"></use>
												</svg>
											</a>
											<style>
												.btn-wishlist,
												.btn-wishlist-liked {
													width: 40px !important;
													height: 40px !important;
													border-radius: 50% !important;
													display: flex !important;
													align-items: center !important;
													justify-content: center !important;
													transition: background-color 0.3s ease, color 0.3s ease !important;
													position: absolute !important;
													
													top: 10px !important;
													
													right: 10px !important;
													
													z-index: 10 !important;
													background-color: transparent !important;
													color: black !important;
													border: 2px solid #ccc !important;
													
												}

												.btn-wishlist-liked {
													background-color: red !important;
													color: white !important;
												}
											</style>-->

											<!-- H√¨nh ·∫£nh s·∫£n ph·∫©m -->
											<figure th:if="${sanPham != null}">
												<a th:href="@{'/product/' + ${sanPham.maSanPham}}"
													th:title="${sanPham.tenSanPham}">
													<img th:src="@{'/upload/' + ${sanPham.hinhAnh}}" class="tab-image"
														style="width: 100%; height: 200px; object-fit: cover; border-radius: 5px; display: block;"
														alt="S·∫£n ph·∫©m">
												</a>
											</figure>
											<!-- Hi·ªÉn th·ªã gi√° -->
											<div>


												<div class="product-pricing"
													style="display: flex; align-items: center; gap: 13px; justify-content: space-between;">

													<!--<div class="product-price"
														style="font-size: 14px; font-weight: bold; color: #e74c3c;"
														th:text="${sanPhamGiaSauGiamMap[sanPham.maSanPham]} + ' ƒë'">
													</div>-->
													<div class="product-price"
														style="font-size: 14px; font-weight: bold; color: #e74c3c;">
														<span
															th:text="${sanPhamGiaSauGiamMap[sanPham.maSanPham] != null ? #numbers.formatDecimal(sanPhamGiaSauGiamMap[sanPham.maSanPham], 0, 'COMMA', 0, 'POINT') + ' ƒë' : 'ƒêang c·∫≠p nh·∫≠t'}"></span>
													</div>

													<div style="display: flex; align-items: center; gap: 5px;">
														<!-- Gi√° c≈© -->
														<!--<div th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
															style="font-size: 10px; color: #999; text-decoration: line-through; text-align: right;"
															th:text="${sanPham.donGiaBan} + ' ƒë'">
														</div>-->
														<div th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
															style="font-size: 10px; color: #999; text-decoration: line-through; text-align: right;">
															<span
																th:text="${#numbers.formatDecimal(sanPham.donGiaBan, 0, 'COMMA', 0, 'POINT')} + ' ƒë'"></span>
														</div>


														<!-- Ph·∫ßn trƒÉm gi·∫£m gi√° -->
														<span th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
															th:text="'-' + ${sanPhamKhuyenMaiMap[sanPham.maSanPham].phanTramGiamGia} + '%'"
															style="background: #ff4d4f; color: white; padding: 2px 6px; font-size: 10px; border-radius: 3px; font-weight: bold;">
														</span>
													</div>
												</div>



											</div>
											<p class="product-brand"
												th:text="${sanPhamThuongHieuMap[sanPham.maSanPham]}"
												style="font-size: 12px; color: green; font-weight: bold; margin-bottom: 0px;">
											</p>

											<!-- T√™n s·∫£n ph·∫©m -->
											<p class="product-title" th:text="${sanPham.tenSanPham}"
												style="font-size: 16px; font-weight: bold; color: #333; margin-bottom: 1px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
											</p>

											<!-- ƒê√°nh gi√° -->
											<div class="product-rating"
												style="color: #f1c40f; font-size: 14px; margin-top: 2px;">
												<span
													th:text="${sanPhamAverageRatingMap[sanPham.maSanPham] != null ? sanPhamAverageRatingMap[sanPham.maSanPham] + ' ‚òÖ' : 'Ch∆∞a c√≥ ƒë√°nh gi√°'}"></span>
											</div>
											<!-- Th√™m th√¥ng tin s·ªë l∆∞·ª£ng c√≤n l·∫°i -->
											<span class="remaining-quantity"
												style="font-size: 12px; color: #555; display: block; margin-top: 5px;">
												S·ªë l∆∞·ª£ng: <span th:text="${sanPhamSoLuongTonKhoMap[sanPham.maSanPham]}"
													style="font-size: 12px;">0</span>
												<span class="qty" th:text="${sanPham.donViTinh.tenDonVi}"
													style="font-size: 11px;">ƒê∆°n v·ªã
													t√≠nh</span>
											</span>

											<!-- S·ªë l∆∞·ª£ng s·∫£n ph·∫©m v√† n√∫t th√™m v√†o gi·ªè h√†ng 

											<div class="product-quantity-container d-flex justify-content-center align-items-center mt-3"
												style="gap: 10px;
												margin-top: auto;
												display: flex;
										        align-items: center;
										        justify-content: center;
										        gap: 10px;
											
												">
												<form th:action="@{/customer/cart/add}" method="post"
													class="d-flex align-items-center">-->
											<!-- √î nh·∫≠p s·ªë l∆∞·ª£ng 
													<input type="number" name="quantity" value="1" min="1"
														class="form-control quantity-input"
														style="width: 80px; border: 2px solid #000; text-align: center;"
														th:id="'quantity_' + ${sanPham.maSanPham}"
														th:data-product-id="${sanPham.maSanPham}" />-->

											<!-- ·∫®n m√£ s·∫£n ph·∫©m trong input hidden ƒë·ªÉ g·ª≠i l√™n server 
													<input type="hidden" name="productId"
														th:value="${sanPham.maSanPham}" />
													<button
														class="btn btn-warning add-to-cart d-flex align-items-center justify-content-center"
														style="
														background-color: #fca503; 
														color: #fff; 
														border: none; 
														
														transition: background-color 0.3s ease;" onmouseover="this.style.backgroundColor='#e68a00';"
														onmouseout="this.style.backgroundColor='#fca503';"
														th:if="${#authentication.name == 'anonymousUser'}"
														data-bs-toggle="offcanvas"
														data-bs-target="#offcanvasLoginAlert">
														<span class="iconify" data-icon="uil:shopping-cart"
															data-inline="false"
															style="font-size: 1.5rem; margin-right: 5px;"></span>
													</button>-->

											<!-- N√∫t th√™m v√†o gi·ªè h√†ng khi ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p 
													<button type="submit"
														class="btn btn-warning add-to-cart d-flex align-items-center justify-content-center"
														style="background-color: #fca503; color: #fff; border: none; transition: background-color 0.3s ease;"
														onmouseover="this.style.backgroundColor='#e68a00';"
														onmouseout="this.style.backgroundColor='#fca503';"
														th:if="${#authentication.name != 'anonymousUser'}"
														th:data-product-id="${sanPham.maSanPham}">
														<span class="iconify" data-icon="uil:shopping-cart"
															data-inline="false"
															style="font-size: 1.5rem; margin-right: 5px;"></span>
													</button>-->


											<!-- N√∫t th√™m v√†o gi·ªè h√†ng -->

											</form>
										</div>

									</div>
								</div>
							</div>
						</div>



					</div>




				</div>

				<!-- Ph√¢n trang -->
				<div
					style="display: flex; justify-content: center; align-items: center; margin-top: 20px; gap: 10px; font-family: Arial, sans-serif;">
					<a th:href="@{/index(page=${currentPage - 1}, size=${size})}" th:if="${currentPage > 0}"
						style="padding: 8px 16px; border: 1px solid #ddd; border-radius: 4px; background-color: #f9f9f9; text-decoration: none; color: #333; font-size: 14px; transition: all 0.3s ease;">
						Tr∆∞·ªõc
					</a>
					<span style="font-size: 14px; color: #555;"
						th:text="'Trang ' + (${currentPage} + 1) + ' / ' + ${totalPages}"></span>
					<a th:href="@{/index(page=${currentPage + 1}, size=${size})}"
						th:if="${currentPage < totalPages - 1}"
						style="padding: 8px 16px; border: 1px solid #ddd; border-radius: 4px; background-color: #f9f9f9; text-decoration: none; color: #333; font-size: 14px; transition: all 0.3s ease;">
						Sau
					</a>
				</div>





			</div>
		</div>
	</div>
	</div>
</section>






<style>
	/* ƒê·ªãnh d·∫°ng chung cho n√∫t y√™u th√≠ch */
	/* CSS cho n√∫t y√™u th√≠ch - Gi·ªØ v·ªã tr√≠ c·ªë ƒë·ªãnh */


	.price {
		font-size: 10px;
		/* K√≠ch th∆∞·ªõc m·∫∑c ƒë·ªãnh cho gi√° */
		font-weight: bold;
		color: black;
		/* M√†u ƒëen cho gi√° ch√≠nh */
	}

	.text-danger {
		font-size: 15px;
		/* K√≠ch th∆∞·ªõc l·ªõn h∆°n cho gi√° ƒë√£ gi·∫£m */
		font-weight: bold;
		color: black;
		/* ƒê·ªïi l·∫°i m√†u ƒëen cho gi√° sau gi·∫£m */
	}

	.text-muted {
		font-size: 6px;
		/* K√≠ch th∆∞·ªõc nh·ªè h∆°n cho gi√° g·ªëc */
		color: red;
		/* M√†u ƒë·ªè cho gi√° g·ªëc */
		text-decoration: line-through;
		/* G·∫°ch ngang cho gi√° g·ªëc */
		display: block;
		margin-bottom: 5px;
		/* Kho·∫£ng c√°ch gi·ªØa gi√° g·ªëc v√† gi√° sau khi gi·∫£m */
	}


	/* CSS ƒë·ªÉ ƒë·∫£m b·∫£o c√°c khung s·∫£n ph·∫©m ƒë·ªìng ƒë·ªÅu */
	.product-item {
		margin: 0px;
		display: flex;
		flex-direction: column;
		justify-content: space-between;
		height: 100%;
		/* ƒê·∫£m b·∫£o khung s·∫£n ph·∫©m bao ph·ªß to√†n b·ªô chi·ªÅu cao */
		border: 1px solid #ddd;
		padding: 10px;
		box-sizing: border-box;
		border-radius: 10px;
		transition: transform 0.3s ease, box-shadow 0.3s ease;
	}

	.product-item figure {
		flex-grow: 1;
		/* Gi√∫p ph·∫ßn h√¨nh ·∫£nh s·∫£n ph·∫©m m·ªü r·ªông */
		text-align: center;
	}

	.product-item h3 {
		margin: 10px 0;
		font-size: 1.2rem;
		line-height: 1.4;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		/* Gi·ªõi h·∫°n hi·ªÉn th·ªã t√™n s·∫£n ph·∫©m t·ªëi ƒëa 2 d√≤ng */
		-webkit-box-orient: vertical;
		overflow: hidden;
		text-overflow: ellipsis;
		/* Th√™m d·∫•u ba ch·∫•m n·∫øu t√™n s·∫£n ph·∫©m qu√° d√†i */
	}

	.qty,
	.price {
		margin-bottom: 10px;
	}

	.product-grid .col {
		display: flex;
		justify-content: center;
		margin-bottom: 20px;
	}

	.product-item .d-flex {
		justify-content: space-between;
		align-items: center;
		margin-top: auto;
		/* ƒê·∫©y ph·∫ßn cu·ªëi c√πng xu·ªëng d∆∞·ªõi c√πng */
	}
</style>

</html>