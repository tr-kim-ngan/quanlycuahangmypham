<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="customer/fragments/head :: head"></head>

<body>
	<header th:replace="customer/fragments/header :: header"></header>

	<main class="container my-4" style="max-width: 900px; margin: auto; padding-top:150px;">
		<h2 class="text-center" style="color: #333; font-weight: bold; margin-bottom: 20px;">ÄÆ¡n hÃ ng cá»§a tÃ´i</h2>

		<!-- Tabs tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng -->
		<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
			<button class="tab-btn" onclick="changeTab('all')" data-status="all">Mua online</button>
			<button class="tab-btn inactive" onclick="changeTab('store')" data-status="store">Mua táº¡i cá»­a hÃ ng</button>
		</div>

		<!-- Thanh menu tráº¡ng thÃ¡i -->
		<div class="order-tabs">
			<a th:href="@{/customer/order(status='all')}" class="order-tab"
				th:classappend="${selectedStatus == 'all'} ? 'active-tab'">
				Táº¥t cáº£
			</a>
			<a th:href="@{/customer/order(status='Má»›i Ä‘áº·t')}" class="order-tab"
				th:classappend="${selectedStatus == 'Má»›i Ä‘áº·t'} ? 'active-tab'">
				Má»›i Ä‘áº·t
			</a>
			<a th:href="@{/customer/order(status='Äang xá»­ lÃ½')}" class="order-tab"
				th:classappend="${selectedStatus == 'Äang xá»­ lÃ½'} ? 'active-tab'">
				Äang xá»­ lÃ½
			</a>
			<a th:href="@{/customer/order(status='ÄÃ£ xÃ¡c nháº­n')}" class="order-tab" th:classappend="${selectedStatus == 'ÄÃ£ xÃ¡c nháº­n'} ? 'active-tab' 
                   ">
				ÄÃ£ xÃ¡c nháº­n
			</a>

			<a th:href="@{/customer/order(status='Äang giao hÃ ng')}" class="order-tab"
				th:classappend="${selectedStatus == 'Äang giao hÃ ng'} ? 'active-tab'">
				Äang giao hÃ ng
			</a>
			<a th:href="@{/customer/order(status='ÄÃ£ hoÃ n thÃ nh')}" class="order-tab"
				th:classappend="${selectedStatus == 'ÄÃ£ hoÃ n thÃ nh'} ? 'active-tab'">
				ThÃ nh cÃ´ng
			</a>
			<a th:href="@{/customer/order(status='ÄÃ£ há»§y')}" class="order-tab"
				th:classappend="${selectedStatus == 'ÄÃ£ há»§y'} ? 'active-tab'">
				ÄÃ£ há»§y
			</a>
		</div>

		<!-- Danh sÃ¡ch Ä‘Æ¡n hÃ ng -->
		<div id="order-list">
			<div th:if="${#lists.isEmpty(donHangs)}" class="no-orders">
				<img src="https://cdn-icons-png.flaticon.com/512/743/743131.png" alt="Giá» hÃ ng rá»—ng"
					style="width: 150px; opacity: 0.7; margin-bottom: 10px;">

				<p>Báº¡n chÆ°a cÃ³ Ä‘Æ¡n hÃ ng nÃ o</p>
				<a href="/" class="continue-shopping">Tiáº¿p tá»¥c mua sáº¯m</a>
			</div>
			<!--
			<div th:each="order : ${donHangs}" class="order-card">
				<h5>ÄÆ¡n hÃ ng sá»‘: <span th:text="${order.maDonHang}"></span></h5>
				<p>NgÃ y Ä‘áº·t: <span th:text="${#temporals.format(order.ngayDat, 'dd/MM/yyyy HH:mm')}"></span></p>
				<p>Äá»‹a chá»‰ giao hÃ ng: <span th:text="${order.diaChiGiaoHang}"></span></p>
				<p>Tráº¡ng thÃ¡i: <span th:text="${order.trangThaiDonHang}"></span></p>
				<p>PhÃ­ váº­n chuyá»ƒn: <span th:text="${order.phiVanChuyen} + ' VND'"></span></p>
				<p>Tá»•ng tiá»n: <span th:text="${order.tongGiaTriDonHang} + ' VND'"></span></p>

				<div class="order-actions">
					<a th:href="@{/customer/order/{maDonHang}(maDonHang=${order.maDonHang})}" class="btn-view">Xem Chi
						Tiáº¿t</a>

					<form th:action="@{/customer/order/cancel}" method="POST"
						th:if="${order.trangThaiDonHang == 'Äang xá»­ lÃ½'}">
						<input type="hidden" name="maDonHang" th:value="${order.maDonHang}" />
						<button type="submit" class="btn-cancel"
							onclick="return confirm('Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n há»§y Ä‘Æ¡n hÃ ng nÃ y khÃ´ng?');">
							Há»§y ÄÆ¡n HÃ ng
						</button>
					</form>
				</div>
			</div>
			-->
			<div th:each="order : ${donHangs}" style="background-color: #fff; border-radius: 10px; padding: 20px; margin-bottom: 15px; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); transition: 0.3s; border-left: 5px solid #007bff;">

				<h5 style="color: #007bff; margin-bottom: 10px;">ğŸ›’ ÄÆ¡n hÃ ng sá»‘: <span
						th:text="${order.maDonHang}"></span></h5>

				<p><strong>ğŸ“… NgÃ y Ä‘áº·t:</strong>
					<span th:text="${#temporals.format(order.ngayDat, 'dd/MM/yyyy HH:mm')}"></span>
				</p>

				<!--<p><strong>ğŸ“ Äá»‹a chá»‰ giao hÃ ng:</strong>
					<span th:text="${order.diaChiGiaoHang}"></span>
				</p>-->

				<!-- âœ… Hiá»ƒn thá»‹ tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng vá»›i mÃ u sáº¯c ná»•i báº­t -->
				<p><strong>ğŸ“Œ Tráº¡ng thÃ¡i:</strong>
					<span th:text="${order.trangThaiDonHang}" th:style="'padding: 5px 10px; border-radius: 5px; font-weight: bold; color: white; background-color: ' + 
                (${order.trangThaiDonHang == 'Má»›i Ä‘áº·t'} ? '#ffcc00' : 
                (${order.trangThaiDonHang == 'Äang xá»­ lÃ½'} ? '#FFA500' : 
                (${order.trangThaiDonHang == 'ÄÃ£ xÃ¡c nháº­n'} ? '#007bff' : 
                (${order.trangThaiDonHang == 'Äang giao hÃ ng'} ? '#17a2b8' : 
                (${order.trangThaiDonHang == 'ÄÃ£ hoÃ n thÃ nh'} ? '#28a745' : 
                (${order.trangThaiDonHang == 'ÄÃ£ há»§y'} ? '#dc3545' : '#6c757d'))))))">
					</span>
					<!--  Hiá»ƒn thá»‹ Icon tráº¡ng thÃ¡i -->
					<span th:switch="${order.trangThaiDonHang}">
						<span th:case="'Má»›i Ä‘áº·t'">ğŸ†•</span>
						<span th:case="'Äang xá»­ lÃ½'">âŒ›</span>
						<span th:case="'ÄÃ£ xÃ¡c nháº­n'">âœ…</span>
						<span th:case="'Äang giao hÃ ng'">ğŸšš</span>
						<span th:case="'ÄÃ£ hoÃ n thÃ nh'">ğŸ‰</span>
						<span th:case="'ÄÃ£ há»§y'">âŒ</span>
						<span th:case="*">ğŸ”µ</span> <!-- Tráº¡ng thÃ¡i khÃ´ng xÃ¡c Ä‘á»‹nh -->
					</span>
				</p>

				<!--<p><strong>ğŸšš PhÃ­ váº­n chuyá»ƒn:</strong>
					<span th:text="${#numbers.formatDecimal(order.phiVanChuyen, 0, 'COMMA', 0, 'POINT')} + ' Ä‘'"></span>
				</p>-->

				<p><strong>ğŸ’° Tá»•ng tiá»n:</strong>
					<span
						th:text="${#numbers.formatDecimal(order.tongGiaTriDonHang, 0, 'COMMA', 0, 'POINT')} + ' Ä‘'"></span>
				</p>

				<!-- ğŸ”¹ NÃºt hÃ nh Ä‘á»™ng -->
				<div style="display: flex; gap: 10px; margin-top: 15px;">
					<!-- NÃºt xem chi tiáº¿t -->
					<a th:href="@{/customer/order/{maDonHang}(maDonHang=${order.maDonHang})}" style="background-color: #007bff; color: white; padding: 8px 12px; border-radius: 5px; 
                  text-decoration: none; transition: 0.3s; font-size: 14px;">
						Xem Chi Tiáº¿t
					</a>

					<!-- NÃºt Há»§y Ä‘Æ¡n hÃ ng (Chá»‰ hiá»ƒn thá»‹ khi tráº¡ng thÃ¡i lÃ  'Äang xá»­ lÃ½') -->
					<form id="cancelForm" th:action="@{/customer/order/cancel}" method="POST"
						onsubmit="return validateCancelReason();" th:if="${order.trangThaiDonHang == 'Äang xá»­ lÃ½'}"
						style="display: inline;">
						<input type="hidden" name="maDonHang" th:value="${order.maDonHang}" />
						<!-- Dropdown chá»n lÃ½ do há»§y -->

						<button id="cancelButton" type="button" style="background-color: #dc3545; color: white; padding: 8px 12px; border-radius: 5px; 
                    border: none; cursor: pointer; transition: 0.3s; font-size: 14px;"
							onmouseover="this.style.backgroundColor='#c82333'"
							onmouseout="this.style.backgroundColor='#dc3545'"
							onclick="return confirm('Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n há»§y Ä‘Æ¡n hÃ ng nÃ y khÃ´ng?');">
							Há»§y ÄÆ¡n HÃ ng
						</button>
						<!-- NÃºt XÃ¡c nháº­n Há»§y (áº¨n lÃºc Ä‘áº§u) -->
						<button type="submit" id="confirmCancelButton" style="display: none; background-color: #dc3545; color: white; padding: 8px 12px; border-radius: 5px; 
     				   border: none; cursor: pointer; transition: 0.3s; font-size: 14px;"
							onclick="return validateCancelReason();">
							XÃ¡c nháº­n há»§y
						</button>
						<select id="cancelReasonDropdown" name="lyDoHuy"
							style="padding: 6px; border-radius: 5px; margin-right: 10px; border: 1px solid #ccc;">
							<option value="">-- Chá»n lÃ½ do há»§y --</option>
							<option value="Äá»•i Ã½, khÃ´ng muá»‘n mua ná»¯a">Äá»•i Ã½, khÃ´ng muá»‘n mua ná»¯a</option>
							<option value="Muá»‘n thay Ä‘á»•i sáº£n pháº©m khÃ¡c">Muá»‘n thay Ä‘á»•i sáº£n pháº©m khÃ¡c</option>
							<option value="Thá»i gian giao hÃ ng quÃ¡ lÃ¢u">Thá»i gian giao hÃ ng quÃ¡ lÃ¢u</option>
							<option value="PhÃ­ váº­n chuyá»ƒn quÃ¡ cao">PhÃ­ váº­n chuyá»ƒn quÃ¡ cao</option>
							<option value="LÃ½ do khÃ¡c">LÃ½ do khÃ¡c</option>
						</select>
					</form>


					<script>
						document.getElementById("cancelButton").addEventListener("click", function () {
							let reasonDropdown = document.getElementById("cancelReasonDropdown");
							let confirmButton = document.getElementById("confirmCancelButton");

							reasonDropdown.style.display = "inline-block"; // Hiá»‡n dropdown
							confirmButton.style.display = "inline-block"; // Hiá»‡n nÃºt xÃ¡c nháº­n há»§y
							this.style.display = "none"; // áº¨n nÃºt Há»§y ÄÆ¡n HÃ ng ban Ä‘áº§u
						});

						function validateCancelReason() {
							let reason = document.getElementById("cancelReasonDropdown").value;
							if (reason === "") {
								alert("Vui lÃ²ng chá»n lÃ½ do há»§y Ä‘Æ¡n hÃ ng.");
								return false;
							}
							return confirm("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n há»§y Ä‘Æ¡n hÃ ng nÃ y khÃ´ng?");
						}
					</script>
				</div>
			</div>

		</div>





		<!-- PhÃ¢n trang -->
		<div class="pagination" style="text-align: center; margin-top: 20px;">
			<ul style="display: inline-flex; list-style: none; padding: 0;">
				<!-- NÃºt Previous (Chá»‰ hiá»ƒn thá»‹ náº¿u currentPage > 0) -->
				<li th:if="${currentPage > 0}">
					<a th:href="@{/customer/order(page=${currentPage - 1}, size=${size}, status=${selectedStatus})}"
						style="padding: 6px 10px; border: 1px solid #ccc; border-radius: 4px; text-decoration: none; 
                      color: #333; background-color: white; margin: 0 5px;">
						â® TrÆ°á»›c
					</a>
				</li>

				<!-- Hiá»ƒn thá»‹ sá»‘ trang -->
				<li th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
					<a th:href="@{/customer/order(page=${i}, size=${size}, status=${selectedStatus})}" th:style="${i == currentPage} ? 
                    'padding: 6px 10px; border: 1px solid #007bff; border-radius: 4px; text-decoration: none; 
                     color: white; background-color: #007bff; font-weight: bold; margin: 0 5px;' :
                    'padding: 6px 10px; border: 1px solid #ccc; border-radius: 4px; text-decoration: none; 
                     color: #333; background-color: white; margin: 0 5px;'" th:text="${i + 1}">
					</a>
				</li>

				<!-- NÃºt Next (Chá»‰ hiá»ƒn thá»‹ náº¿u chÆ°a Ä‘áº¿n trang cuá»‘i) -->
				<li th:if="${currentPage < totalPages - 1}">
					<a th:href="@{/customer/order(page=${currentPage + 1}, size=${size}, status=${selectedStatus})}"
						style="padding: 6px 10px; border: 1px solid #ccc; border-radius: 4px; text-decoration: none; 
                      color: #333; background-color: white; margin: 0 5px;">
						Sau â¯
					</a>
				</li>
			</ul>
		</div>


	</main>

	<footer th:replace="customer/fragments/footer :: footer"></footer>

	<style>
		.order-tabs {
			display: flex;
			border-bottom: 2px solid #eee;
			padding-bottom: 10px;
			margin-bottom: 20px;
		}

		.order-tab {
			text-decoration: none;
			color: #333;
			margin-right: 20px;
			font-weight: bold;
			cursor: pointer;
		}

		.order-tab:hover,
		.order-tab.active-tab {
			color: #ff6600;
			font-weight: bold;
		}

		.order-card {
			background-color: #fff;
			border-radius: 10px;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			padding: 15px;
			margin-bottom: 15px;
		}

		.order-actions {
			display: flex;
			gap: 10px;
		}

		.btn-view {
			background-color: #007bff;
			color: white;
			padding: 8px 12px;
			border-radius: 5px;
			text-decoration: none;
		}

		.btn-cancel {
			background-color: #dc3545;
			color: white;
			padding: 8px 12px;
			border-radius: 5px;
			border: none;
			cursor: pointer;
		}

		.pagination {
			text-align: center;
			margin-top: 20px;
		}

		.page-link {
			text-decoration: none;
			padding: 6px 10px;
			border: 1px solid #ccc;
			color: #333;
			border-radius: 4px;
			font-size: 16px;
			margin: 0 5px;
		}

		.active-page {
			background-color: #007bff;
			color: white;
			border: 1px solid #007bff;
		}

		.no-orders {
			text-align: center;
			margin-top: 50px;
		}

		.continue-shopping {
			display: inline-block;
			background-color: #007bff;
			color: white;
			padding: 10px 20px;
			border-radius: 20px;
			text-decoration: none;
		}
	</style>
	<!--import Ä‘á»ƒ dÃ¹ng avatar-->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>