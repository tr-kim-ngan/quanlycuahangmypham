<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{customer/fragments/head :: head}"></head>

<body>
	<!-- Header -->
	<div th:replace="~{customer/fragments/header :: header}"></div>
	<!-- End Header -->
	<main class="container my-5" style="padding-top: 130px;">
		<div class="row justify-content-center">
			<div class="col-lg-10">
				<!-- ‚úÖ Ch·ªâ hi·ªÉn th·ªã danh s√°ch h√≥a ƒë∆°n n·∫øu ch∆∞a ch·ªçn h√≥a ƒë∆°n chi ti·∫øt -->
				<div th:if="${hoaDon == null}">
					<div class="text-center mb-4">
						<h2 class="fw-bold text-dark">üìú Danh S√°ch H√≥a ƒê∆°n</h2>
						<p class="text-muted">D∆∞·ªõi ƒë√¢y l√† th√¥ng tin c√°c h√≥a ƒë∆°n b·∫°n ƒë√£ ƒë·∫∑t.</p>
					</div>

					<div class="card shadow-lg p-4 rounded-4" style="border-left: 5px solid #ff6600;">
						<table class="table table-hover align-middle text-center">
							<thead class="table-dark text-white">
								<tr>
									<th>M√£ H√≥a ƒê∆°n</th>
									<th>Ng√†y Xu·∫•t</th>
									<th>T·ªïng Ti·ªÅn</th>
									<th>Thao T√°c</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="hoaDon : ${hoaDons}" class="fw-bold">
									<td th:text="${hoaDon.maHoaDon}"></td>
									<td th:text="${#temporals.format(hoaDon.ngayXuatHoaDon, 'dd/MM/yyyy HH:mm')}"></td>
									<td class="text-success fw-bold"
										th:text="${#numbers.formatDecimal(hoaDon.tongTien, 0, 'COMMA', 0, 'POINT')} + ' VND'">
									</td>
									<td>
										<a th:href="@{/customer/hoadon/{maDonHang}(maDonHang=${hoaDon.donHang.maDonHang})}"
											class="btn btn-outline-primary rounded-pill px-3">Xem Chi Ti·∫øt</a>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>

				<!-- ‚úÖ Ch·ªâ hi·ªÉn th·ªã chi ti·∫øt h√≥a ƒë∆°n khi ƒë√£ ch·ªçn m·ªôt h√≥a ƒë∆°n -->
				<div th:if="${hoaDon != null}" class="mt-5">
					<div class="card p-4 shadow-lg rounded-4 border-0">
						<h4 class="fw-bold text-center text-primary">Chi Ti·∫øt H√≥a ƒê∆°n</h4>
						<div class="row mt-4">
							<!-- C·ªôt 1 -->
							<div class="col-md-6">
								<p><strong>Ng√†y Xu·∫•t:</strong>
									<span class="text-dark fw-bold"
										th:text="${#temporals.format(hoaDon.ngayXuatHoaDon, 'dd/MM/yyyy HH:mm')}"></span>
								</p>

								<p><strong>Ng∆∞·ªùi Nh·∫≠n:</strong> <span class="text-dark fw-bold"
										th:text="${hoaDon.tenNguoiNhan}"></span></p>
								<p><strong>S·ªë ƒêi·ªán Tho·∫°i:</strong> <span class="text-dark fw-bold"
										th:text="${hoaDon.soDienThoaiNhanHang}"></span>
								</p>
								<p><strong>ƒê·ªãa Ch·ªâ:</strong> <span class="text-dark fw-bold"
										th:text="${hoaDon.diaChiGiaoHang}"></span></p>

							</div>

							<!-- C·ªôt 2 -->
							<div class="col-md-6">



								<p><strong>T·ªïng Gi√° Tr·ªã S·∫£n Ph·∫©m:</strong>
									<span class="text-dark fw-bold" th:text="${tongGiaTriSanPham} + ' VND'"></span>
								</p>

								<p><strong>Ph√≠ V·∫≠n Chuy·ªÉn:</strong>
									<span class="text-dark fw-bold" th:text="${phiVanChuyen} + ' VND'"></span>
								</p>
								<p><strong>T·ªïng Gi√° Tr·ªã:</strong>
									<span class="text-dark fw-bold" th:text="${tongGiaTriDonHang} + ' VND'"></span>
								</p>
							<!--	<p><strong>S·ªë ti·ªÅn ƒë√£ tr·∫£:</strong>
									<span class="text-dark fw-bold" style="color: red;"
										th:text="${#numbers.formatDecimal(hoaDon.tongTien, 0, 'COMMA', 0, 'POINT')} + ' VND'">
									</span>
								</p>-->



							</div>
						</div>


						<!-- Danh s√°ch s·∫£n ph·∫©m -->
						<table class="table table-striped mt-3">
							<thead class="table-light">
								<tr>
									<th>#</th>
									<th>H√¨nh ·∫¢nh</th>
									<th>S·∫£n Ph·∫©m</th>

									<th>Gi√°</th>
									<th>Th√†nh Ti·ªÅn</th>
									<th>ƒê√°nh Gi√°</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="chiTiet, iterStat : ${hoaDon.donHang.chiTietDonHangs}">
									<td th:text="${iterStat.count}"></td>
									<td class="text-center">
										<img th:src="@{'/upload/' + ${chiTiet.sanPham.hinhAnh}}"
											class="rounded shadow-sm" style="width: 80px; height: auto;">
									</td>
									<td class="fw-bold">
										<span th:text="${chiTiet.sanPham.tenSanPham}"></span>
										<br>
										<span class="text-muted">S·ªë l∆∞·ª£ng: <span
												th:text="${chiTiet.soLuong}"></span></span>
									</td>

									<td class="text-dark"
										th:text="${#numbers.formatDecimal(chiTiet.giaTaiThoiDiemDat, 0, 'COMMA', 0, 'POINT')} + ' VND'">
									</td>
									<td class="fw-bold text-primary"
										th:text="${#numbers.formatDecimal(chiTiet.giaTaiThoiDiemDat.multiply(new java.math.BigDecimal(chiTiet.soLuong)), 0, 'COMMA', 0, 'POINT')} + ' VND'">
									</td>
									<td>
										<a th:if="${danhGiaStatuses[iterStat.index]}"
											th:href="@{'/customer/hoadon/' + ${hoaDon.maHoaDon} + '/danhgia/' + ${chiTiet.sanPham.maSanPham} + '/view'}"
											class="btn btn-outline-success rounded-pill px-3">Xem ƒê√°nh Gi√°</a>
										<a th:if="${!danhGiaStatuses[iterStat.index]}"
											th:href="@{'/customer/hoadon/' + ${hoaDon.maHoaDon} + '/danhgia/' + ${chiTiet.sanPham.maSanPham}}"
											class="btn btn-outline-secondary rounded-pill px-3">ƒê√°nh Gi√°</a>
									</td>
								</tr>
							</tbody>
						</table>

						<!-- N√∫t Quay l·∫°i -->
						<div class="text-center mt-4">
							<a th:href="@{/customer/hoadon}" class="btn btn-outline-dark rounded-pill px-4">üîô Quay
								L·∫°i</a>
						</div>
					</div>
				</div>

			</div>
		</div>
	</main>

	<!-- Footer -->
	<div th:replace="~{customer/fragments/footer :: footer}"></div>
	<!-- End Footer -->
	<!-- Core JS Files -->
	<div th:replace="~{customer/fragments/script :: script}"></div>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

	<!-- End JS -->
</body>

</html>